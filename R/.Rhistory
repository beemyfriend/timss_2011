tree.timss <- tree(benchmark_math_avg_value~.-IDSTUD, data = model, subset = train)
tree.pred = predict(tree.timss, tree_test, type = 'class')
table(tree.pred, test_benchmark)
}
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
timss_student_tree()
timss_student_tree <- function(model, train_ratio = .75, seed = 7777){
set.seed(seed)
train <- sample(1:nrow(model), nrow(model)*train_ratio)
tree_train <- model[train,]
tree_test <- model[-train,]
test_benchmark <- model$benchmark_math_avg_value[-train]
tree.timss <- tree(benchmark_math_avg_value~.-IDSTUD, data = model, subset = train)
tree.pred = predict(tree.timss, tree_test, type = 'class')
table(tree.pred, test_benchmark)
}
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
timss_student_tree()
tree_model_student_school
detach(package:tree)
detach(package:randomForest())
detach(package:randomForest
)
svm_model_chile_all_adjusted <- chile_all_influential_columns %>%
adjust_student_benchmark() %>%
prep_for_svm(c('IDSTUD', 'benchmark_math_avg_value')) %>%
analyze_model(timss_student_svm)
?sample.int
timss_student_svm <- function(model, train_ratio = .75, seed = 1111){
set.seed(seed)
train <- sample(nrow(model), (nrow(model) * train_ratio))
svm_train <- model[train,]
svm_test <- model[-train,]
out = svm(benchmark_math_avg_value~.-IDSTUD, data = svm_train, kernel='linear', cost = 10)
pred.te = predict(out, newdata = svm_test)
table(pred.te, svm_test$benchmark_math_avg_value)
}
svm_model_chile_all_adjusted <- chile_all_influential_columns %>%
adjust_student_benchmark() %>%
prep_for_svm(c('IDSTUD', 'benchmark_math_avg_value')) %>%
analyze_model(timss_student_svm)
svm_model_chile_all_adjusted
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
library(tree)
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
library(randomForest)
tree_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
detach(package:e1071)
detach(package:klaR)
detach(package:caret)
detach(package:klaR)
detach(package:MASS)
library(randomForest)
tree_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_student_school <- student_school_influential_columns %>%
dplyr::select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_school
tree_model_student_school
tree_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_student_school
tree_model_student_teacher <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_student_teacher_adjusted <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_teacher
tree_model_student_school_adjusted <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_student <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_student_student_adjusted <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_student_student
tree_model_chile_all <- chile_all_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_chile_all_adjusted <- chile_all_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_chile_all_adjusted <- chile_all_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_chile_all
tree_model_chile_all_adjusted
tree_model_chile_all_adjusted <- chile_all_11 %>%
mutate(counter = 1) %>%
spread(IDSCHOOL, counter) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree)
tree_model_simple_adjusted <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree)
tree_model_simple
tree_models_original <- list(tree_model_simple, tree_model_student_school, tree_model_student_teacher, tree_model_student_student, tree_model_chile_all)
tree_models_adjusted <- list(tree_model_simple_adjusted, tree_model_student_school_adjusted, tree_model_student_teacher_adjusted, tree_model_student_student_adjusted, tree_model_chile_all_adjusted)
compare_accuracy(tree_models_original)
compare_accuracy(tree_models_adjusted)
?randomForest
student_student_influential_columns[c(1,2,55),]$benchmark_math_avg_value
timss_student_rforest <- function(df, train_ratio = .75, seed = 1212){
set.seed(seed)
train <- sample(nrow(df), (nrow(df) * train_ratio))
rf.timss <- randomForest(benchmark_math_avg_value~.-IDSTUD,
data = df,
subset = train,
importance = T)
yhat.rf <- predict(rf.timss, newdata = df[-train,])
table(yhat.rf, df[-train,]$benchmark_math_avg_value)
}
rforest_model_simple <- chile_simple_student_11 %>%
timss_student_rforest()
rforest_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
timss_student_rforest()
rforest_model_simple
rforest_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
rforest_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_simple_adjustued <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
rforest_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_student_school
rforest_model_student_school_adjusted <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
rforest_model_student_teacher <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_student_teacher
rforest_model_student_student <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_student_student_adjusted <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
rforest_model_chile_all <- chile_all_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_rforest)
rforest_model_chile_all_adjusted <- chile_all_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
detach(package:randomForest)
rforest_models_original <- list(rforest_model_simple, rforest_model_student_school, rforest_model_student_teacher, rforest_model_student_student, rforest_model_chile_all)
rforest_models_adjusted <- list(rforest_model_simple_adjusted, rforest_model_student_school_adjusted, rforest_model_student_teacher_adjusted, rforest_model_student_student_adjusted, rforest_model_chile_all_adjusted)
compare_accuracy(rforest_models_original)
compare_accuracy(rforest_models_adjusted)
library(randomForest)
rforest_model_simple_adjusted <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
detach(package:randomForest)
rforest_models_original <- list(rforest_model_simple, rforest_model_student_school, rforest_model_student_teacher, rforest_model_student_student, rforest_model_chile_all)
rforest_models_adjusted <- list(rforest_model_simple_adjusted, rforest_model_student_school_adjusted, rforest_model_student_teacher_adjusted, rforest_model_student_student_adjusted, rforest_model_chile_all_adjusted)
compare_accuracy(rforest_models_original)
compare_accuracy(rforest_models_adjusted)
rforest_models_adjusted <- list(rforest_model_simple_adjusted, rforest_model_student_school_adjusted, rforest_model_student_teacher_adjusted, rforest_model_student_student_adjusted, rforest_model_chile_all_adjusted)
rforest_model_student_teacher
rforest_model_student_teacher_adjusted
library(randomForest)
rforest_model_student_teacher_adjusted <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest)
rforest_models_adjusted <- list(rforest_model_simple_adjusted, rforest_model_student_school_adjusted, rforest_model_student_teacher_adjusted, rforest_model_student_student_adjusted, rforest_model_chile_all_adjusted)
compare_accuracy(rforest_models_original)
compare_accuracy(rforest_models_adjusted)
analyze_model <- function(df, model_func, model_name){
model_table <- model_func(df)
model_info <- list()
model_info[[1]] = model_table
correct_in_col <- c()
total_in_col <- c()
correct_ratio <- c()
for(i in 1:ncol(model_table)){
correct_in_col[i] = model_table[i,i]
total_in_col[i] = model_table[,i] %>%
sum()
correct_ratio[i] = str_c(dimnames(model_table)[[1]][i], ': ', round((100 * correct_in_col[i]/total_in_col[i]), 2), '%')
}
correct_ratio_mean <- mean(correct_in_col/total_in_col)
correct_ratio[length(correct_ratio) + 1] = str_c('Overall: ',round((100 * sum(correct_in_col)/sum(total_in_col)), 2), '%')
model_info[[2]] = c(correct_in_col/total_in_col, sum(correct_in_col)/sum(total_in_col))
model_info[[3]] = correct_ratio
guess_table <- table(df$benchmark_math_avg_value, df$benchmark_math_avg_value)
model_info[[4]] = guess_table
model_info[[5]] = max(total_in_col)/sum(total_in_col)
model_info[[6]] = str_c('Just guessing \'', dimnames(model_table)[[1]][which.max(total_in_col)], '\': ', round((100 * max(total_in_col)/sum(total_in_col)), 2),'%')
model_info[[7]] = correct_ratio_mean
model_info[[8]] = model_name
names(model_info) <- c('confusion_matrix', 'accuracy', 'accuracy_explained', 'truth_matrix', 'optimized_single_guess','optimized_single_guess_explained', 'correct_ratio_mean', 'model_name')
model_info
}
rforest_model_chile_all_adjusted <- chile_all_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_rforest, 'FOREST: Full Combo Adjusted')
rforest_model_chile_all_adjusted
?knitr::kable
c(c(1, 2), c(3, 4))
df <- data.frame(a =C(), b = C())
c()
x = c()
x
df = data_frame(a, b, c)
df = data_frame('a', 'b', 'c')
df
df = data_frame(c(1, 2, 3))
df
?data_frame
data_frame('a' = 'a', 'b'= 2)
warnings()
table_df <- data_frame('Model_name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below_low' = 1, 'Optimized_Guess' = 'chr')
table_df
warnings()
table_df <- table_df %>%
select(-Advanced, -Below_Low)
table_df
table_df <- table_df %>%
select(-Advanced, -Below_Low)
table_df <- data_frame('Model_name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below_Low' = 1, 'Optimized_Guess' = 'chr')
table_df <- table_df %>%
select(-Advanced, -Below_Low)
table_df
table_df[2, 1] = 'hi'
table_df
table_df[2, 2] = 2
table_df
round((.35555 * 100), 2)
svm_model_chile_all[[2]]
svm_model_chile_all[[2]][1]
svm_model_chile_all_adjusted[[2]]
compare_accuracy <- function(list_models, is_adjusted = F){
table_df <- data_frame('Model_name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below_Low' = 1, 'Overall' = 1,'Optimized_Guess' = 'chr')
if(!is_adjusted){
table_df <- table_df %>%
select(-Advanced, -Below_Low)
}
for(i in seq_along(list_models)){
for(j in seq_along(list_models[[i]][[2]])){
table_df[i, j+1] <- round((list_models[[i]][[2]][j] *100), 2)
}
table_df[i, 1] <- list_models[[i]][[8]]
table_df[i, length(names(table_df))] <- list_models[[i]][[8]]
}
table_df
}
library(tree)
tree_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Simple')
tree_model_simple_adjusted <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Simple Adjusted')
tree_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-School Combo')
tree_model_student_school_adjusted <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-School Combo Adjusted')
tree_model_student_teacher <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-Teacher Combo')
tree_model_student_teacher_adjusted <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-Teacher Combo Adjusted')
tree_model_student_student <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-Student Combo')
tree_model_student_student_adjusted <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-Student Combo Adjusted')
tree_model_chile_all <- chile_all_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Full Combo')
tree_model_chile_all_adjusted <- chile_all_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Full Combo Adjusted')
detach(package:tree)
tree_models_original <- list(tree_model_simple, tree_model_student_school, tree_model_student_teacher, tree_model_student_student, tree_model_chile_all)
tree_models_adjusted <- list(tree_model_simple_adjusted, tree_model_student_school_adjusted, tree_model_student_teacher_adjusted, tree_model_student_student_adjusted, tree_model_chile_all_adjusted)
tree_models_original
compare_accuracy(tree_models_original)
compare_accuracy(tree_models_adjusted, T)
compare_accuracy <- function(list_models, is_adjusted = F){
table_df <- data_frame('Model_name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below_Low' = 1, 'Overall' = 1,'Optimized_Guess' = 'chr')
if(is_adjusted){
table_df <- table_df %>%
select(-Advanced, -Below_Low)
}
for(i in seq_along(list_models)){
for(j in seq_along(list_models[[i]][[2]])){
table_df[i, j+1] <- round((list_models[[i]][[2]][j] *100), 2)
}
table_df[i, 1] <- list_models[[i]][[8]]
table_df[i, length(names(table_df))] <- list_models[[i]][[8]]
}
table_df
}
compare_accuracy(tree_models_original)
compare_accuracy(tree_models_original)
tree_model_chile_all
df
table_df
table_df['High']
analyze_model <- function(df, model_func, model_name){
model_table <- model_func(df)
model_info <- list()
model_info[[1]] = model_table
correct_in_col <- c()
total_in_col <- c()
correct_ratio <- c()
benchmark_levels <- c()
for(i in 1:ncol(model_table)){
correct_in_col[i] = model_table[i,i]
total_in_col[i] = model_table[,i] %>%
sum()
correct_ratio[i] = str_c(dimnames(model_table)[[1]][i], ': ', round((100 * correct_in_col[i]/total_in_col[i]), 2), '%')
benchmark_levels[i] = dimnames(model_table)[[1]][i]
}
correct_ratio_mean <- mean(correct_in_col/total_in_col)
correct_ratio[length(correct_ratio) + 1] = str_c('Overall: ',round((100 * sum(correct_in_col)/sum(total_in_col)), 2), '%')
model_info[[2]] = c(correct_in_col/total_in_col, sum(correct_in_col)/sum(total_in_col))
model_info[[3]] = c(benchmark_levels, c('Overall'))
model_info[[4]] = correct_ratio
model_info[[5]] = table(df$benchmark_math_avg_value, df$benchmark_math_avg_value)
model_info[[6]] = max(total_in_col)/sum(total_in_col)
model_info[[7]] = str_c('Just guessing \'', dimnames(model_table)[[1]][which.max(total_in_col)], '\': ', round((100 * max(total_in_col)/sum(total_in_col)), 2),'%')
model_info[[8]] = correct_ratio_mean
model_info[[9]] = model_name
names(model_info) <- c('confusion_matrix', 'accuracy', 'accuracy_explained', 'truth_matrix', 'optimized_single_guess','optimized_single_guess_explained', 'correct_ratio_mean', 'model_name')
model_info
}
library(tree)
tree_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Simple')
tree_model_simple
analyze_model <- function(df, model_func, model_name){
model_table <- model_func(df)
model_info <- list()
model_info[[1]] = model_table
correct_in_col <- c()
total_in_col <- c()
correct_ratio <- c()
benchmark_levels <- c()
for(i in 1:ncol(model_table)){
correct_in_col[i] = model_table[i,i]
total_in_col[i] = model_table[,i] %>%
sum()
correct_ratio[i] = str_c(dimnames(model_table)[[1]][i], ': ', round((100 * correct_in_col[i]/total_in_col[i]), 2), '%')
benchmark_levels[i] = dimnames(model_table)[[1]][i]
}
correct_ratio_mean <- mean(correct_in_col/total_in_col)
correct_ratio[length(correct_ratio) + 1] = str_c('Overall: ',round((100 * sum(correct_in_col)/sum(total_in_col)), 2), '%')
model_info[[2]] = c(correct_in_col/total_in_col, sum(correct_in_col)/sum(total_in_col))
model_info[[3]] = c(benchmark_levels, c('Overall'))
model_info[[4]] = correct_ratio
model_info[[5]] = table(df$benchmark_math_avg_value, df$benchmark_math_avg_value)
model_info[[6]] = max(total_in_col)/sum(total_in_col)
model_info[[7]] = str_c('Just guessing \'', dimnames(model_table)[[1]][which.max(total_in_col)], '\': ', round((100 * max(total_in_col)/sum(total_in_col)), 2),'%')
model_info[[8]] = correct_ratio_mean
model_info[[9]] = model_name
names(model_info) <- c('confusion_matrix', 'accuracy', 'benchmark_levels','accuracy_explained', 'truth_matrix', 'optimized_single_guess','optimized_single_guess_explained', 'correct_ratio_mean', 'model_name')
model_info
}
warning()
library(tree)
tree_model_simple <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Simple')
tree_model_simple_adjusted <- chile_simple_student_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Simple Adjusted')
tree_model_student_school <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-School Combo')
tree_model_student_school_adjusted <- student_school_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-School Combo Adjusted')
tree_model_student_teacher <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-Teacher Combo')
tree_model_student_teacher_adjusted <- student_teacher_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-Teacher Combo Adjusted')
tree_model_student_student <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Student-Student Combo')
tree_model_student_student_adjusted <- student_student_influential_columns %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Student-Student Combo Adjusted')
tree_model_chile_all <- chile_all_11 %>%
select(-IDSCHOOL) %>%
analyze_model(timss_student_tree, 'TREE: Full Combo')
tree_model_chile_all_adjusted <- chile_all_11 %>%
select(-IDSCHOOL) %>%
adjust_student_benchmark() %>%
analyze_model(timss_student_tree, 'TREE: Full Combo Adjusted')
detach(package:tree)
data_frame['hi']
tree_model_chile_all_adjusted
table_df
table_df[3,'High']
table_df[2,'High']
table_df[2,'High'] <- 22
table_df
table_df <- data_frame('Model name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below_Low' = 1, 'Overall' = 1,'Optimized Guess' = 'chr')
table_df
table_df[2, 'Model Name'] <- 'other_chr'
table_df
table_df[2, 'Model name'] <- 'other_chr'
table_df
compare_accuracy <- function(list_models, is_adjusted = F){
table_df <- data_frame('Model Name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below Low' = 1, 'Overall' = 1,'Optimized Guess' =  1)
if(is_adjusted){
table_df <- table_df %>%
select(-Advanced, -Below_Low)
}
for(i in seq_along(list_models)){
for(j in seq_along(list_models[[i]][[2]])){
table_df[i, list_models[[i]][[3]][j]] <- round((list_models[[i]][[2]][j] * 100), 2)
}
table_df[i, 'Model Name'] <- list_models[[i]][[9]]
table_df[i, 'Optimized Guess'] <- round((list_models[[i]][[6]] * 100), 2)
}
table_df
}
tree_models_original <- list(tree_model_simple, tree_model_student_school, tree_model_student_teacher, tree_model_student_student, tree_model_chile_all)
tree_models_adjusted <- list(tree_model_simple_adjusted, tree_model_student_school_adjusted, tree_model_student_teacher_adjusted, tree_model_student_student_adjusted, tree_model_chile_all_adjusted)
compare_accuracy(tree_models_original)
compare_accuracy(tree_models_adjusted, T)
tree_models_adjusted <- list(tree_model_simple_adjusted, tree_model_student_school_adjusted, tree_model_student_teacher_adjusted, tree_model_student_student_adjusted, tree_model_chile_all_adjusted)
compare_accuracy(tree_models_adjusted, T)
table_df
table_df %>% select(`Model name`)
compare_accuracy <- function(list_models, is_adjusted = F){
table_df <- data_frame('Model Name' = 'chr', 'Advanced' = 1, 'High' = 1, 'Intermediate' = 1, 'Low' = 1, 'Below Low' = 1, 'Overall' = 1,'Optimized Guess' =  1)
if(is_adjusted){
table_df <- table_df %>%
select(-Advanced, -`Below Low`)
}
for(i in seq_along(list_models)){
for(j in seq_along(list_models[[i]][[2]])){
table_df[i, list_models[[i]][[3]][j]] <- round((list_models[[i]][[2]][j] * 100), 2)
}
table_df[i, 'Model Name'] <- list_models[[i]][[9]]
table_df[i, 'Optimized Guess'] <- round((list_models[[i]][[6]] * 100), 2)
}
table_df
}
compare_accuracy(tree_models_adjusted, T)
